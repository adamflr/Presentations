<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics Exercise 1. Introduction to Excel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Exercise_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Exercise_1_files/libs/quarto-html/quarto.js"></script>
<script src="Exercise_1_files/libs/quarto-html/popper.min.js"></script>
<script src="Exercise_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Exercise_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Exercise_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Exercise_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Exercise_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Exercise_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Exercise_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#three-crosses-filling-cells-and-moving-data" id="toc-three-crosses-filling-cells-and-moving-data" class="nav-link" data-scroll-target="#three-crosses-filling-cells-and-moving-data"><span class="header-section-number">2</span> Three crosses: Filling cells and moving data</a></li>
  <li><a href="#mathematical-operations-and-filling-cells" id="toc-mathematical-operations-and-filling-cells" class="nav-link" data-scroll-target="#mathematical-operations-and-filling-cells"><span class="header-section-number">3</span> Mathematical operations and filling cells</a></li>
  <li><a href="#relative-and-absolute-references" id="toc-relative-and-absolute-references" class="nav-link" data-scroll-target="#relative-and-absolute-references"><span class="header-section-number">4</span> Relative and absolute references</a>
  <ul class="collapse">
  <li><a href="#references-when-moving-cells" id="toc-references-when-moving-cells" class="nav-link" data-scroll-target="#references-when-moving-cells"><span class="header-section-number">4.1</span> References when moving cells</a></li>
  </ul></li>
  <li><a href="#ready-made-functions" id="toc-ready-made-functions" class="nav-link" data-scroll-target="#ready-made-functions"><span class="header-section-number">5</span> Ready-made functions</a></li>
  <li><a href="#a-look-at-some-actual-data" id="toc-a-look-at-some-actual-data" class="nav-link" data-scroll-target="#a-look-at-some-actual-data"><span class="header-section-number">6</span> A look at some actual data</a>
  <ul class="collapse">
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure"><span class="header-section-number">6.1</span> Data structure</a></li>
  </ul></li>
  <li><a href="#filter-data" id="toc-filter-data" class="nav-link" data-scroll-target="#filter-data"><span class="header-section-number">7</span> Filter data</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">8</span> Sorting</a></li>
  <li><a href="#graphs" id="toc-graphs" class="nav-link" data-scroll-target="#graphs"><span class="header-section-number">9</span> Graphs</a>
  <ul class="collapse">
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot"><span class="header-section-number">9.1</span> Scatter plot</a></li>
  <li><a href="#bar-chart" id="toc-bar-chart" class="nav-link" data-scroll-target="#bar-chart"><span class="header-section-number">9.2</span> Bar chart</a></li>
  <li><a href="#pie-chart" id="toc-pie-chart" class="nav-link" data-scroll-target="#pie-chart"><span class="header-section-number">9.3</span> Pie chart</a></li>
  </ul></li>
  <li><a href="#upcoming-material" id="toc-upcoming-material" class="nav-link" data-scroll-target="#upcoming-material"><span class="header-section-number">10</span> Upcoming material</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Exercise_1.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics Exercise 1. Introduction to Excel</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>MS Excel is widely used in the sciences to organize and analyze data. It includes functions for most basic data operations in a simple-to-overview interface and it is available in most professional organisations.</p>
<p>In this exercise we will look at</p>
<ul>
<li>filling cells and moving data,</li>
<li>referencing cells,</li>
<li>data organisation,</li>
<li>the basic graphs (point, bar and line),</li>
<li>applying functions.</li>
</ul>
</section>
<section id="three-crosses-filling-cells-and-moving-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Three crosses: Filling cells and moving data</h1>
<p>The main parts of the interface is the <em>ribbon</em> at the top where various functionalities can be selected with the mouse, a <em>formula bar</em> (for a new workbook this will simply be an empty space right below the ribbon) where data or formulae can be written, and the spreadsheet area where data and output is placed.</p>
<ol type="1">
<li>Let’s start by filling a column with some numbers. Write <em>ID</em> in the top left cell <code>A1</code>. Then fill the column with values from 1 to 10.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Pointers.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Three types of pointers.</figcaption>
</figure>
</div>
<p>If we want to mark some data (for example to copy it or to apply a function) we can click in one cell and drag to another. The marked area will have a green border. The operation of clicking and dragging has a few different uses in Excel. If the marker is a bold white, clicking and dragging will mark and area. If the marker is placed on the green border of a marked area the marker changes to a cross with arrows at the end; this marker is used to move cells. Finally, if the marker is placed on the bottom right corner of a marked area the marker changes to a thin black cross; this marker is used to auto-fill an area.</p>
<ol start="2" type="1">
<li>Write <em>ID2</em> in <code>B1</code>. Then write 1 in <code>B2</code> and 2 in <code>B3</code>. Mark the cells <code>B2:B3</code> using the bold white cross. Then place the pointer on the bottom right corner of the marked area, turning the pointer into the thin black cross. Click and drag down to <code>B11</code>. Alternatively, mark <code>B2:B3</code>, then double-click the green square at the bottom right of the marked area.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/02-auto-fill-column.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Auto-filling a column with inceasing numbers.</figcaption>
</figure>
</div>
</section>
<section id="mathematical-operations-and-filling-cells" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Mathematical operations and filling cells</h1>
<p>One of the common data operations is the transform a column using some mathematical operation. Examples include changing the unit from hectograms to grams and calculating tree volume based on diameter and height. In Excel operations like these can be done by doing the calculation in one cell and then filling that operation to all rows in the data.</p>
<ol start="3" type="1">
<li>We want to calculate a new column given by the ID value plus 10, divided by 2. Write a column name <em>y</em> in <code>C1</code>. Then go to <code>C2</code> and write <code>=(B2+10)/2</code>. Here, the equal sign is used to start a formula, and the calculation is given as the value in <code>B2</code> plus 10 and then divided by 2. The use of parenthesis follows standard mathematical rules so the operation within parenthesis is carried out first.</li>
<li>Next, we want that calculation for every row. This can be done by filling down. A few different ways are equivalent:</li>
</ol>
<ol type="a">
<li>Click the calculated cell <code>C2</code> and double-click the green square at the bottom right of the marked cell.</li>
<li>Click the calculated cell <code>C2</code>, click the green square at the bottom right of the marked cell, and drag down to row 11.</li>
<li>Mark cells <code>C2</code> to <code>C11</code> and click <em>ctrl + D</em>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/03-mathematical-formula.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A mathematical formula.</figcaption>
</figure>
</div>
</section>
<section id="relative-and-absolute-references" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Relative and absolute references</h1>
<p>If we click any cell in the new column C we can see the formula in the formula bar. The calculation is different for each cell in that each formula is connected to a different cell in the B column. When we filled the C column, the formula changed with each row, so that <code>C5</code> is connected to <code>B5</code>, <code>C6</code> to <code>B6</code> and so on. This is an example of a <em>relative</em> reference. The reference is relative to the current cell: a reference to a cell one step to the left will change when we fill in any direction.</p>
<p>If we don’t want the references to change we can set an <em>absolute</em> reference This is done with <code>$</code> such as <code>$C$4</code> to lock both column and row, alternatively <code>$C4</code> or <code>C$4</code> to only lock one of them. The F4 key is a shortcut for placing dollarsigns.</p>
<ol start="5" type="1">
<li>Give the name <em>Relative</em> to column D. Write <code>=C5</code> in the cell <code>D2</code> and fill down.</li>
<li>Give the name <em>Absolute</em> to column E. Write <code>=$C$5</code> in the cell <code>E2</code> and fill down.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/04-relative-relation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A relative reference is just the cell name, for example <code>=C5</code>.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/05-absolute-relation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">An absolute reference is set with a dollarsign, for example <code>=$C$5</code>.</figcaption>
</figure>
</div>
<p>Relative and absolute references are often mixed in a single formula. Say for example that we want to multiply some number with the values in <em>ID</em>, but we want to be flexible with what that number is. We can then use some cell to hold that number and multiply each row value with that cell.</p>
<ol start="7" type="1">
<li>Write the value 7 in an empty cell, say <code>I2</code>. Give the name <em>F</em> to column F. Write <code>=A1*$I$2</code> in <code>F2</code> and fill down. What happens when the value in <code>I2</code> is changed?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/06-relative-absolute-mix.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A mix of relative and absolute references can be useful to add interactivity in a document.</figcaption>
</figure>
</div>
<section id="references-when-moving-cells" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="references-when-moving-cells"><span class="header-section-number">4.1</span> References when moving cells</h2>
<p>As we saw when discussing the types of pointer a marked area can be used with the arrow cross by placing the cursor on the border of the marked area and clicking-and-dragging. Another alternative is to cut with <em>ctrl + X</em> and paste with <em>ctrl + V</em>. In modern Excel versions the references are fixed when moving a cell.</p>
<ol start="8" type="1">
<li>The cell <code>C2</code> references to <code>A2</code>. Move <code>C2</code> to some empty place and note the formula of the cell. Then move it back to <code>C2</code> again.</li>
<li>The cell <code>A2</code> is referenced by <code>C2</code>. Move <code>A2</code> to some empty place and note the formula in <code>C2</code>. Then move the cell back to <code>A2</code>.</li>
</ol>
</section>
</section>
<section id="ready-made-functions" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Ready-made functions</h1>
<p>A function is some operation that takes an input and produces an output. We saw an example of a function when calculating column <em>C</em>. Excel includes a large number of functions for different operations. You can see some of these by going to <em>Formula</em> in the ribbon and selecting a topic. Some key functions from a statistical point-of-view is to take a sum or a mean, possibly by some grouping.</p>
<ol start="10" type="1">
<li>The sum function is called <code>SUM</code> and takes a range of values as input, giving the sum of those values as output. In cell <code>I3</code>, calculate the sum of column <code>C</code>.</li>
<li>The mean function is called <code>MEAN</code> and takes a range of values as input, giving the mean of those values as output. In cell <code>I4</code>, calculate the mean of column <code>C</code>.</li>
<li>We almost always want to calculate sums or means for each of multiple groups. One way to do this is by <code>SUMIF</code> and <code>MEANIF</code>. Start by giving column <em>G</em> a name <em>Grouping</em> and setting the first five values to <em>a</em> and the remaining to <em>b</em>. Mark an empty cell, say <code>I5</code> and write the formula <code>=SUMIF(G2:G11,"a",F2:F11)</code>. The <code>SUMIF</code> function takes three inputs: the grouping area, the condition to check, and the sum area. We can read this as <em>in the range G2 to G11, where the value is equal to </em>a<em>, sum the values in F2 to F11</em>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/07-sum-function.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The sum function takes a range (multiple cells) as input and gives the sum of the valeus as output.</figcaption>
</figure>
</div>
<p>The <code>MEANIF</code> function is one way to calculate mean values by different groups. We will later see another, more flexible, way using pivot tables.</p>
</section>
<section id="a-look-at-some-actual-data" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> A look at some actual data</h1>
<p>Let us now turn to some real-world data to explore two common data operations: filtering (where specific observations are chosen from the full set) and sorting (where the data is ordered according to some criteria). The data covers land use in three categories for a few different regions over time. It can be found on the course Canvas page as <em>Agricultural-land-use.xlsx</em>. The source is <em>Our World in Data</em>; more information at https://ourworldindata.org/land-use.</p>
<ol start="13" type="1">
<li>Find the file on Canvas. Download it to a suitable folder. Open the file in Excel.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/09-real-world-data.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Some real-world data. Each row is an observed unit and each column is a property of that unit.</figcaption>
</figure>
</div>
<section id="data-structure" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="data-structure"><span class="header-section-number">6.1</span> Data structure</h2>
<p>The land use data is a table where each row is given by a region (column <em>Entity</em>) and a year (column <em>Year</em>). There are then three numerical variables for land type (<em>Built-up area</em>, <em>Grazing</em>, and <em>Cropland</em>). This type of data can be structured in a few different ways. The most basic structure would be to have columns for area, year and land-use with a single numerical variable. An example of this is given in the sheet <em>Long format</em>. Another format could be to let region and land-use define each row and have one column for each year.</p>
<p>When talking about different data structures we use the terms <em>longer</em> and <em>wider</em>. A longer dataset is one where there are more rows and a wider dataset is one where there are more columns. The operation of going from one structure to another is called <em>pivoting</em>.</p>
</section>
</section>
<section id="filter-data" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Filter data</h1>
<p>It is very common that we are interested in a subset of the rows in our dataset – we want to <em>filter</em> the data for certain rows. One simple way to filter in Excel is to add <em>filter buttons</em> to our dataset. This can be done by selecting the data, clicking the <em>Sort and Filter</em> button in the <em>Start</em> ribbon and selecting <em>Filter</em>. If done correctly small arrows are added to each column name. Clicking these arrows will give some options for filtering.</p>
<ol start="14" type="1">
<li>Use the filter for region and year to select the row for <em>World</em> in <em>1960</em>.</li>
<li>For numerical variables the filter menu has some specific options. Use these to filter for <em>World</em> since <em>1960</em>, i.e 1960 and all later observations.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/11-filter.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Setting a filter on the data using the filter button.</figcaption>
</figure>
</div>
<p>To remove a filter one can click the filter button and clear the current filter. This can also be done under <em>Sort and Filter</em> in the ribbon.</p>
</section>
<section id="sorting" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Sorting</h1>
<p>The buttons at the top of each column can also be used for sorting the data according to some variable.</p>
<ol start="16" type="1">
<li>Remove any filter. Sort the data by <em>Cropland</em> in decreasing order.</li>
<li>If there is a filter on a dataset and the data is sorted, only the filtered rows will be sorted. As an example of this, apply a filter on the year <em>600</em>, sort by <em>Cropland</em> in decreasing order, and remove the filter. What happens to the order of the data? It is therefore important to keep track of any filters.</li>
</ol>
<p>Since sorting changes the order of the data it is good to have a column of row IDs so that one can easily go back to the original order by sorting by ID. As a general rule the interpretation of a dataset should not rely one the order. It should be possible to randomly reorder the rows without losing any information.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/12-sort-button.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Sorting can be done using the button at the top of a column.</figcaption>
</figure>
</div>
</section>
<section id="graphs" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Graphs</h1>
<p>Excel includes a large number of functions for graphs. The behaviour of Excels graph function depend on the structure of the data and the amount of work needed to create an understandable, neat-looking graph can vary quite a bit depending on data format and graph type. Nonetheless, Excel is a flexible tool, both in the types of graphs that are available and in the detailed appearance of the graph. Here we look at four of the most fundamental graph types: a scatter plot, a bar chart, and a pie chart.</p>
<section id="scatter-plot" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="scatter-plot"><span class="header-section-number">9.1</span> Scatter plot</h2>
<p>A scatter plot illustrates two numeric variables, one on the x-axis and one on the y-axis. Each observation is a point in the graph located at the (x,y)-coordinates given by the two variables. Common variations are to color points according to a group variable or to connect the size of the point to a third variable (a bubble graph).</p>
<ol start="18" type="1">
<li>In the first sheet of the land use data, filter the data for the year 2016. Then mark the columns for grazing and cropland. Then go to the <em>Insert</em> ribbon and find the mini-button for the scatter plot (bottom middle of the graph icons). Click it to see some suggested graph. Select the basic one, with only points.</li>
<li>The default graph is missing axis labels. These can be added in a few different ways, for example by clicking in a white space of the graph and adding a graph element with the plus buttom which should appear to the top-right of the graph. Use this to add labels to the graph.</li>
<li>The appearance of a graph can be changed to fairly great detail. Try double-clicking a point to reach an editor. The menu at the top of the editor window (the text typically start with <em>Alternatives for</em>) can be used to select a specific part of the graph to change. Try to find change the color of the points.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/13-scatter-selection.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A scatter plot can be produced by marking the relevant data and selecting a scatter plot in the Insert ribbon.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/14-scatter-produced.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The produced graph can be alterd in the formatting window to the right.</figcaption>
</figure>
</div>
</section>
<section id="bar-chart" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="bar-chart"><span class="header-section-number">9.2</span> Bar chart</h2>
<p>A bar chart illustrates a numerical value as the height of a bar. Commonly multiple bars are shown in one graph, with each bar connected to a group in a categorical variable. The bar can be divided into different sections by a filled in color.</p>
<ol start="21" type="1">
<li>We want to create a bar chart which for a given year shows each land use for each geographical entity. Filter for a single year, say 2010. Then mark the columns for Entity and the three numerical columns. This can be done by clicking in the column header (where there is a letter indicating the column) and then clicking the other three columns while holding the <em>ctrl</em> key (on a windows system). Then we go to the <em>Insert</em> ribbon and select the bar chart icon among the different graph options. There are a few different options depending on whether one want grouped bars (the sections standing next to each other) or stacked bars (the sections placed on top of each other). Pick whichever you prefer.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/15-bar-produced.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">An example of the bar chart.</figcaption>
</figure>
</div>
</section>
<section id="pie-chart" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="pie-chart"><span class="header-section-number">9.3</span> Pie chart</h2>
<p>A pie chart illustrates the parts of a total as sectors of a circle (the <em>pie</em>). It shows the relative sizes of different groups. The pie chart has met some criticism for being difficult to read and it is generally recommended to not use a pie chart when the number of groups is large or when the differences between groups is small. In those cases, a bar chart with grouped bars may be clearer.</p>
<ol start="22" type="1">
<li>A pie chart can be made with just a single column of numerical data, but typically we also want a categorical variable to create labels for each sector. In the first sheet of the excel file, filter for a particular year, then mark the column with region and the numerical values with grazing. Then select the pie chart icon in the <em>Insert</em> ribbon. Pick the top-left standard pie chart. The resulting pie chart should have a legend showing which sector belongs to what region.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/16-pie-produced.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">An example of a pie chart.</figcaption>
</figure>
</div>
</section>
</section>
<section id="upcoming-material" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Upcoming material</h1>
<p>In the next computer exercise we will look at</p>
<ul>
<li>using pivot tables to calculate summary statistics of different variables for each of multiple groups,</li>
<li>using pivot tables to create graphs with some basic interactivity,</li>
<li>produce some of the standard scientific graphs (boxplots, barcharts with errorbars, and the histogram).</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>