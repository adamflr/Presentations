<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics Exercise 2. Scientific graphs, inference and regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Exercise_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Exercise_2_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Exercise_2_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Exercise_2_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="Exercise_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Exercise_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Exercise_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Exercise_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Exercise_2_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Exercise_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Exercise_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Exercise_2_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#scientific-graphs" id="toc-scientific-graphs" class="nav-link" data-scroll-target="#scientific-graphs"><span class="header-section-number">2</span> Scientific graphs</a>
  <ul class="collapse">
  <li><a href="#barchart-with-errorbars" id="toc-barchart-with-errorbars" class="nav-link" data-scroll-target="#barchart-with-errorbars"><span class="header-section-number">2.1</span> Barchart with errorbars</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">2.2</span> Boxplot</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="header-section-number">2.3</span> Histogram</a></li>
  </ul></li>
  <li><a href="#ecological-data" id="toc-ecological-data" class="nav-link" data-scroll-target="#ecological-data"><span class="header-section-number">3</span> Ecological data</a>
  <ul class="collapse">
  <li><a href="#ecological-population-data" id="toc-ecological-population-data" class="nav-link" data-scroll-target="#ecological-population-data"><span class="header-section-number">3.1</span> Ecological population data</a></li>
  <li><a href="#diversity-indices" id="toc-diversity-indices" class="nav-link" data-scroll-target="#diversity-indices"><span class="header-section-number">3.2</span> Diversity indices</a></li>
  </ul></li>
  <li><a href="#adding-an-add-in-in-excel" id="toc-adding-an-add-in-in-excel" class="nav-link" data-scroll-target="#adding-an-add-in-in-excel"><span class="header-section-number">4</span> Adding an add-in in Excel</a></li>
  <li><a href="#comparing-groups" id="toc-comparing-groups" class="nav-link" data-scroll-target="#comparing-groups"><span class="header-section-number">5</span> Comparing groups</a></li>
  <li><a href="#test-outcomes-through-simulations" id="toc-test-outcomes-through-simulations" class="nav-link" data-scroll-target="#test-outcomes-through-simulations"><span class="header-section-number">6</span> Test outcomes through simulations</a></li>
  <li><a href="#relations-between-numerical-variables" id="toc-relations-between-numerical-variables" class="nav-link" data-scroll-target="#relations-between-numerical-variables"><span class="header-section-number">7</span> Relations between numerical variables</a>
  <ul class="collapse">
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">7.1</span> Correlation</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">7.2</span> Regression</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Exercise_2.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics Exercise 2. Scientific graphs, inference and regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>In this exercise we turn toward more statistics-specific graphs and calculations. In the first part we look at three graphs which are common in scientific presentations: the bar chart with errorbars, the boxplot, and the histogram. In the second part we look at how ecological population data can be analyzed with statistical tests.</p>
<p>In the first part we work some example data on global socio-economics. The source is the Gapminder foundation. In the second part we work with some scientific data on bird species at different sites.</p>
</section>
<section id="scientific-graphs" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Scientific graphs</h1>
<section id="barchart-with-errorbars" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="barchart-with-errorbars"><span class="header-section-number">2.1</span> Barchart with errorbars</h2>
<p>In the previous exercise we saw the humble barchart, where a summary measure like a mean is shown as the height of a bar for each of a few different groups. In scientific publications the barchart is almost always developed using an errorbar which shows the dispersion in the distribution measured with a standard deviation or the precision of the mean estimate measured with a standard error.</p>
<p>The first step is to calculate mean values and standard deviations. We will do this for each year in the Gapminder data using a pivot table.</p>
<ol type="1">
<li>In the <em>Gapminder.xlsx</em> file, click anywhere in the data (such as <code>A1</code>). Then go to the <em>Insert</em> ribbon and select <em>PivotTable</em>. The dialog window should say that the input data is the full dataset and that the pivot table is printed in a new sheet. Click <em>OK</em> to produce an empty table.</li>
<li>The new window should have the pivot table field to the right. Drag the variable <em>year</em> to <em>Rows</em> and <em>liveExp</em> to <em>Values</em>. The default is to calculate the sum, but this can be changed to the mean by clicking the small arrow next to <em>Sum of lifeExp</em>, selecting <em>Value Field Settings</em>, and then taking <em>Average</em> in the list of functions.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/204-average-life2.png" class="img-fluid figure-img"></p>
<figcaption>Changing the type of calculation in a pivot table.</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>In a similar way we can add the standard deviation to the table. Drag <em>lifeExp</em> from the list of variables to <em>Values</em>. Go to <em>Value Field Settings</em> and select <em>StdDev</em> for the standard deviation.</li>
<li>It is possible to create a bar chart using a <em>PivotChart</em>, but since we need to add an errorbar we will use a trick to use a standard graph. The trick is to create a parallel non-pivot table by referencing the pivot table. Click an empty cell such as <code>G4</code> and link the first data cell in the pivot table by writing the formula <code>=A4</code>. Auto-fill that cell to the right for each column and down for each row (except for the <em>Grand Total</em>). Give this new table suitable headers (<em>Year</em>, <em>Mean</em> and <em>SD</em>).</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/206-para-table2.png" class="img-fluid figure-img"></p>
<figcaption>Creating a shadow table from a pivot table.</figcaption>
</figure>
</div>
<ol start="5" type="1">
<li>Create the bar chart by marking the columns with <em>Year</em> and <em>Mean</em>, then going to the <em>Insert</em> ribbon and selecting the graph icon for a barchart.</li>
<li>Errorbars can now be added by clicking the green plus to the right of the graph, clicking the arrow by <em>Error Bars</em> and selecting <em>More Options</em>. In the margin window which now appears select <em>Custom</em> and <em>Specify values</em> at the very bottom. In the dialog window remove the text and select the values in the column <em>SD</em>. Do the same for both <em>Positive</em> and <em>Negative</em>. Click <em>OK</em>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/211-barchart-error2.png" class="img-fluid figure-img"></p>
<figcaption>Adding errorbars to a barchart.</figcaption>
</figure>
</div>
<p>One good final step is to test if the connection is correct by changing one of the standard deviations to something large. We should then see a change in the graph.</p>
</section>
<section id="boxplot" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">2.2</span> Boxplot</h2>
<p>A boxplot visualises the distribution of data as a box with <em>whiskers</em>. The box splits the observations into four groups: the lowest quarter of values is below the box; the second lowest is in the box but under the middle bar; the second highest quarter is in the box above the bar; and the highest quarter is above the box. It is also possible to visualise extreme values as dot and to add a marker for the mean value.</p>
<p>In modern Excel versions it is very easy to create a boxplot. Here we create a boxplot for life expectancy over time.</p>
<ol start="7" type="1">
<li>In the sheet with all data, mark the columns for <em>year</em> and <em>lifeExp</em>. Go to the <em>Insert</em> ribbon and find the small graph icon for <em>Statistic Chart</em> (typically in the middle row and middle column of icons). Select <em>Box and Whisker</em> to create a boxplot.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/214-boxplot-select.png" class="img-fluid figure-img"></p>
<figcaption>Creating a boxplot from two columns of data.</figcaption>
</figure>
</div>
<p>Clicking one of the boxes opens a formatting window to the right. The default in Excel is to show the mean value as a cross.</p>
<p>Make sure you understand the construction of the boxplot and how it displays the quartiles of the data. The boxplot can give a quick idea of the distribution of the data points. For life expectancy the data is quite symmetric, but if we look at gdp per capita the boxes will be more skewed, indicating a longer right tail in those distributions.</p>
</section>
<section id="histogram" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="histogram"><span class="header-section-number">2.3</span> Histogram</h2>
<p>A histogram shows the distribution of a variable by dividing the x-axis into intervals (<em>bins</em>) and letting bars show the number of observations in each interval. We illustrate this using some <em>wide</em> data in the sheet <em>Wide-lifeExp</em>.</p>
<ol start="8" type="1">
<li>Select the column with observations from 1967. Go to the <em>Insert</em> ribbon and find the graph icon for <em>Statistic Chart</em>. Select <em>Histogram</em>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/216-histogram-wide-select.png" class="img-fluid figure-img"></p>
<figcaption>Creating a histogram.</figcaption>
</figure>
</div>
<ol start="9" type="1">
<li>The resulting histogram has automatically selected intervals on the x-axis. To change these, click anywhere in the x-axis. In the window to the right, find the icon with three bars and the section with <em>Axis options</em>. Set the bin width to a suitable value (for example 5) and set the value in <em>Underflow bin</em> to a value which is larger than the lowest value in the data.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/217-histogram-bins.png" class="img-fluid figure-img"></p>
<figcaption>Changing the bins of a histogram.</figcaption>
</figure>
</div>
</section>
</section>
<section id="ecological-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Ecological data</h1>
<section id="ecological-population-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ecological-population-data"><span class="header-section-number">3.1</span> Ecological population data</h2>
<p>We will now look at some real-world ecological data from a study at the Southern Swedish Forest Research Center. The file <em>Bird data.xlsx</em> contains observation numbers for different bird species. Each column is a species and each row is a site. It is natural that we want to compare the distribution of species between sites, but since some sites will have larger number overall, an initial step is to transform the observations from counts to proportion by dividing by the site total.</p>
<ol start="10" type="1">
<li>Copy the data sheet by right-clicking the sheet name at the bottom and selecting <em>Move or Copy</em>.</li>
<li>In the new sheet click the first data observation in <code>B5</code>. For each cell we want to take the cell value and divide it by the sum total, which here is the sum of the row. We can do this for the first cell <code>B5</code> with the formula <code>=BLAD1!B5 / SUM(BLAD1!B5:BLAD1!AD5)</code>. Note that the sheet name followed by <code>!</code> indicates a different sheet than the current one.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/219-bird-proportions.png" class="img-fluid figure-img"></p>
<figcaption>Calculating proportions from count data.</figcaption>
</figure>
</div>
<ol start="12" type="1">
<li>If we want to autofill this cell downwards and to the right we have to be a bit careful with which cells should be absolute (i.e.&nbsp;fixed with <code>$</code>) and which should be relative. When we autofill to the right, we want the numerator cell to change, but the we want the columns to be absolute in the denominator <code>SUM()</code>. Also, when we autofill down, we want the rows to always change. The formula should therefore be <code>=BLAD1!B5 / SUM(BLAD1!$B5:BLAD1!$AD5)</code>. Autofilling that formula both to all columns and all rows will give proportions for each site.</li>
</ol>
<p>Cells in Excel can be formatted for individual fonts, color background, font color and many other aspect. Here we use this to make the data sheet into a heatmap.</p>
<ol start="13" type="1">
<li>Mark the data cells in <code>B5</code> to <code>AD36</code>. Go to the <em>Home</em> ribbon and find the icon for <em>Conditional Formatting</em>. Go to <em>Color Scales</em> and pick any color scheme. The result is that each cell has a color indicating the magnitude of the proportion. If one wants to change the width of columns one can drag the black line between column headers (in the grey area with letters). One can zoom out using the slider at the bottom right.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/221-bird-format.png" class="img-fluid figure-img"></p>
<figcaption>Adding conditional formatting to cells.</figcaption>
</figure>
</div>
<p>The heatmap can be really useful to get an idea of patterns in the data, for example which species are more common and if there are differences between the two groups of sites (treatment and control sites).</p>
</section>
<section id="diversity-indices" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="diversity-indices"><span class="header-section-number">3.2</span> Diversity indices</h2>
<p>It is common to reduce the data from multiple variables (one per species) to a single variable. This can be done using <em>diversity indices</em>. There are a few different types of indices. Here we look at <em>Simpson’s index</em>, which is one minus the sum of squared proportions.</p>
<ol start="14" type="1">
<li>Go to the first empty column <code>AE</code>. We want to calculate one minus the sum of squared proportions for each site. A square sum can be calculated with the <code>SUMSQ()</code> function. Here we get <code>=1-SUMSQ(B5:AD5)</code>, then autofilling down for each row.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/223-bird-simpson2.png" class="img-fluid figure-img"></p>
<figcaption>Calculate Simpson’s index for the first row.</figcaption>
</figure>
</div>
<ol start="15" type="1">
<li>Add a <em>Conditional Formatting</em> to the index column. Is there any indication of difference between treatment and control sites?</li>
<li>The diversity index can be illustrated with a boxplot. In order to do this we want one column which specifies the type of site and the numerical column of index values. In the first column we have an indicator of site type, but there is a unique identifier, so it cannot be used directly in a graph. Look into using the function <code>LEFT</code> to extract the first letter of the first column. Then construct a boxplot showing each of the two site types. The easiest way to construct a boxplot is to have the numerical columns to the right of the categorical column; one quick way to do that is to copy the numerical column and paste it to the right.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/225-bird-first-letter.png" class="img-fluid figure-img"></p>
<figcaption>Use the <code>LEFT</code> function to extract the first letter from the column with site id.</figcaption>
</figure>
</div>
</section>
</section>
<section id="adding-an-add-in-in-excel" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Adding an add-in in Excel</h1>
<p>We move on to look at the calculation of p-values in Excel. One way to do this is by using an add-in called Analysis ToolPak. This needs to be activated before use. The exact way to do this may differ a bit between Excel version.</p>
<ol type="1">
<li>Open an empty Excel workbook. Go to <em>File</em> in the ribbon at the top. Go to <em>Options</em> at the bottom of the list to the left.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/301-options.png" class="img-fluid figure-img"></p>
<figcaption>Finding options under File.</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>In the new window, find <em>Add-ins</em> in the list to the left. This will give a page showing the current active and inactive add-ins. At the bottom of that page, click <em>Go…</em>, then check the <em>Analysis ToolPak</em> and click <em>OK</em>. Go back to empty sheet and go to the <em>Data</em> ribbon. If the add-in has been successfully added there should be a button to the right of the ribbon with the name <em>Data Analysis</em>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/302-addins.png" class="img-fluid figure-img"></p>
<figcaption>Add add-ins by clicking the Go button at the bottom.</figcaption>
</figure>
</div>
</section>
<section id="comparing-groups" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Comparing groups</h1>
<p>One fundamental use of statistics in the science is to test hypotheses using a method called <em>null hypothesis significance testing</em>. One example of this is the two-sample t-test. Two hypotheses are set up: a null hypothesis which states that two groups are equal in population mean and an alternative hypothesis which states that they are not equal. Based on underlying statistical theory it is possible to calculate a p-value. The p-value is the probability of getting a more extreme difference between the two groups than the difference we are observing. If the data is completely in line with the null hypothesis the p-value is one and if the data is very far from the null hypothesis the p-value is near zero. A p-value below 0.05 gives that the null hypothesis is <em>rejected</em> and that there is a <em>significant</em> difference between the groups.</p>
<p>At the end of the last computer exercise we calculated diversity index for each site in the bird experiment. We saw that there was some visual difference between the treatment group and the control group. Let us now do a formal test to see if this difference is significant.</p>
<ol start="3" type="1">
<li>Download the Excel file <em>Computer-exercise-3.xlsx</em> from the Canvas page. Find the sheet <em>bird-tree-experiment</em>, which contains the indices per site. This data is in what we would call long form with each site one row.</li>
<li>For clarity, state the hypotheses in an empty area next to the data. The null hypothesis is that the two groups have the same population mean diversity, while the alternative is that there is a difference in population means.</li>
<li>The p-value of a test can be calculated in a few different way. The most straight-forward is to use the <code>T.TEST</code> function. In an empty area below the null and alternative hypothesis, write <code>T.TEST(F2:F17;F18:F33;2;2)</code>. The function has four argument:</li>
</ol>
<ul>
<li>the first argument <code>F2:F17</code> is the data for the first group,</li>
<li>the second argument <code>F18:F33</code> is the data for the second group,</li>
<li>the third argument, here a <code>2</code>, states that the test should be <em>two-tailed</em> which means that we are testing both for an increasing effect of the treatment and for a decreasing effect,</li>
<li>the fourth argument, here a <code>2</code>, sets the type of tests. Here we want a test for two-samples with an assumption of equal variances.</li>
</ul>
<ol start="6" type="1">
<li>The result of the <code>T.TEST</code> function is the p-value. Interpret the p-value. Is there a significant difference between the control and the treatment? What is the interpretation of this in terms of the actual example?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/306-div-t-test2.png" class="img-fluid figure-img"></p>
<figcaption>Presentation of the p-value after calculating it using the <code>T.TEST</code> function.</figcaption>
</figure>
</div>
<p>A t-test can also be done using the <em>Analysis ToolPak</em>. This gives a will give some additional information as well.</p>
<ol start="7" type="1">
<li>Go to the <em>Data</em> ribbon and click the <em>Data analysis</em> button to the right.</li>
<li>Find the method called <em>t-Test: Two-Sample Assuming Equal Variances</em> and click <em>OK</em>.</li>
<li>In the dialog window select the observation from the control as the first range and those of the treatment as the second range. Set the hypothesized mean difference to zero. Let the output be in a new sheet. The output shows the mean, variance and number of observation of both variables. The pooled variance, df (for <em>degrees of freedom</em>), <em>t Stat</em> and the two <em>t Critical</em> values are measures used when calculating the test. <em>P(T&lt;=t) one-tail</em> is the one-tailed p-value (which is rarely used) and <em>P(T&lt;=t) two-tail</em> is the two-tailed p-value. The latter should be the same as that given by <code>T.TEST</code>.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/308-t-test-analysis-toolpak2.png" class="img-fluid figure-img"></p>
<figcaption>Input to the t-test function in Analysis Toolpak.</figcaption>
</figure>
</div>
<ol start="8" type="1">
<li>The sheets labeled <em>teabags</em> (and a year) contain the data from the teabag decomposition experiment. It is sorted by green/red tea. Use this data to test for a difference in decomposition between red and green tea.</li>
</ol>
<p>The hypothesis test is not perfect. It is possible to have actual population differences that are not captured by the test, as well as equal populations which by pure chance result in samples which give a significant difference. Of course, we cannot know this since we cannot observe the actual populations, but we can understand this phenomena using simulations.</p>
</section>
<section id="test-outcomes-through-simulations" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Test outcomes through simulations</h1>
<p>The sheet <em>simulation</em> contains a case where samples are generated from known populations. The samples are randomly generated by Excel. To make a new draw one can press <em>delete</em> while marking an empty cell.</p>
<p>At the top of the sheet one can set the mean and standard deviations of two normal distributions. These are the distributions from which the random samples are drawn. Below that the two distributions are illustrated as curves. Further below we see the two random samples - six from each population. Below that is the test information. We can see the p-value and a text stating the conclusion of the test as accepting or rejecting the null hypothesis. As always the null hypothesis is that the two groups have the same population mean.</p>
<ol start="9" type="1">
<li>Make sure the populations have the same mean (say 30 for both). Mark an empty cell and press delete to generate a new random sample. Note the p-value. Since we set the populations to be equal, the <em>correct</em> outcome is for the test to accept the null hypothesis. This will however not always happen. Re-do the random sample forty times and note how often the test rejects the null hypothesis.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/310-sim1.png" class="img-fluid figure-img"></p>
<figcaption>Simulation where the null hypothesis is true.</figcaption>
</figure>
</div>
<ol start="10" type="1">
<li>Next let the populations be quite difference. For example one population can have mean 40 and one population mean 30, with both standard deviations being 2. Re-do the random sample a few time and note how often the test reject.</li>
<li>Finally, set the populations to being similar but with some overlap. This could for example be means of 30 and 31 and both distributions having standard deviation of 2. This is a case where we would like the test to reject the null hypothesis since there is an actual difference between the populations. This will however not always happen. Re-do the sampling a few times. Is it common for the test to accept the null hypothesis?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/311-sim2.png" class="img-fluid figure-img"></p>
<figcaption>Simulation where the null hypothesis is false.</figcaption>
</figure>
</div>
<p>These two possible errors are known as type I and type II, with type I being the case of rejecting a true null hypothesis (a low p-value even though the populations are the same) and type II being the case of accepting a false null hypothesis (a high p-value even though the populations are different). The hypothesis tests are constructed so that the probability of a type I error equals the significance level, so in most cases this risk is five percent.</p>
</section>
<section id="relations-between-numerical-variables" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Relations between numerical variables</h1>
<p>We often want to capture the relation between two numerical variables. It could for example be the effect of soil pH on teabag decomposition, or the relation between time and tree height. There are two fundamental methods for this. <em>Correlation</em>, which gives a measure between -1 and 1 of how strong the connection between variables is, and <em>regression</em>, which models one variable (a <em>response</em>) as a function of another (an <em>explanatory</em> variable).</p>
<section id="correlation" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="correlation"><span class="header-section-number">7.1</span> Correlation</h2>
<p>The correlation between two variables can be calculated with the function <code>CORREL</code>. The input are the two ranges of cells and the output is the correlation measure. Here we calculate the correlation between flipper size and body size from a data on penguins measurement. This is an extract from the <em>Palmer penguins data</em>, a commonly used example data. See allisonhorst.github.io/palmerpenguins for additional information.</p>
<ol start="12" type="1">
<li>Go to the sheet <em>penguins</em>. It contains data on species and various size measurements for sixty penguins. Go to an empty cell beside the dataset, for example <code>L2</code>. Write the formula <code>=CORREL(E2:E61;F2:F61)</code>. The output should be the correlation between flipper length (the E column) and body mass (the F columns). Is there a positive or negative correlation? What is the interpretation of this in terms of the original variables?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/312-correl1.png" class="img-fluid figure-img"></p>
<figcaption>Calculating the correlation with <code>CORREL</code>.</figcaption>
</figure>
</div>
<ol start="13" type="1">
<li>Use the correlation function <code>CORREL</code> to calculate the correlation flippers and body mass for each of the three species. Are these correlations larger or smaller than the overall correlation?</li>
<li>The difference between groups can be illustrated with a scatterplot with different colors for different species. This requires a that the data is given as different <em>series</em> in the graph, which can be done by separating them into different columns. An examples of this can be seen in the sheet <em>penguins-separate-series</em>. Mark the four data columns (columns B, C, D and E) and insert a scatterplot by going to the <em>Insert</em> ribbon and picking the small icon for the scatter (usually bottom middle of the icons). This should give a scatterplot where each of the groups can be seen in different colors. The range of the axes can be changed by double-clicking and axis and changing the range in the format window to the right. Given the graph, are the calculated correlations reasonable?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/314-correl-scatter.png" class="img-fluid figure-img"></p>
<figcaption>Scatterplot with colors by group.</figcaption>
</figure>
</div>
</section>
<section id="regression" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="regression"><span class="header-section-number">7.2</span> Regression</h2>
<p>In <em>regression</em> a response variable (<em>y</em>) is seen as a function of another function (<em>x</em>). We can illustrate (and get the estimates) of this model using the scatterplot.</p>
<ol start="15" type="1">
<li>Go to the <em>penguins</em> sheet and produce a scatterplot of flipper and body mass. (By marking the data for those two columns and inserting a scatterplot). Next click the green plus next to the graph and select <em>Trendline</em>. You will see a dotted line in the graph. Double-click to reach the format window to the right. Find the section with <em>Trendline options</em> and check <em>Display Equation on chart</em>. This should give an equation in the graph. Try to interpret this model equation. What is the value of y when the x-variable is zero? How much does y increase when x increases by one unit?</li>
<li>We can get some additional information using the <em>Analysis ToolPak</em>. Go to the <em>Data</em> ribbon and click the <em>Data Analysis</em> button to the right. Select <em>Regression</em> from the list of methods. In the dialog window mark the data for body mass as the range of x and the data for flipper length as the range of y. Let the output be in a new worksheet.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/315-reg1.png" class="img-fluid figure-img"></p>
<figcaption>Input to the regression function in Analysis Toolpak.</figcaption>
</figure>
</div>
<p>The most import part of the output is the bottom table. This shows the estimates for the intercept and the slope (<em>Coefficients</em>) and a p-value. The null hypothesis of these tests is that the intercept and slope are zero. A low p-value of the slope indicates that there is a significant connection between the two variables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/316-reg-output.png" class="img-fluid figure-img"></p>
<figcaption>Output from the regression function in Analysis Toolpak.</figcaption>
</figure>
</div>
<ol start="17" type="1">
<li>Redo the regression using only the data for the Adelie penguins. Is the p-value for the slope smaller or greater than that for the full data? How does this relate to the scatterplot where the data was split by species?</li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>